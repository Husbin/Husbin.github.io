<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="与其临渊羡鱼，不如退而结网。">
<meta property="og:type" content="website">
<meta property="og:title" content="Husbin">
<meta property="og:url" content="http://easywork.xin/page/4/index.html">
<meta property="og:site_name" content="Husbin">
<meta property="og:description" content="与其临渊羡鱼，不如退而结网。">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Husbin">
<meta name="twitter:description" content="与其临渊羡鱼，不如退而结网。">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://easywork.xin/page/4/"/>





  <title>Husbin</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta custom-logo">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Husbin</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">与其临渊羡鱼，不如退而结网。</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-schedule">
          <a href="/schedule/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br />
            
            日程表
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/02/06/html-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/06/html-1/" itemprop="url">HTML标签分类总结</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-06T16:51:42+08:00">
                2018-02-06
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web基础知识/" itemprop="url" rel="index">
                    <span itemprop="name">web基础知识</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>要回家了有点按捺不住心里的躁动，来点简单轻松的话题。</p>
<h3 id="先祭出一张导图"><a href="#先祭出一张导图" class="headerlink" title="先祭出一张导图"></a>先祭出一张导图</h3><p><img src="http://upload-images.jianshu.io/upload_images/7166236-56a3d9aabca88961.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="HTML元素 (1).png"></p>
<ul>
<li>日常安利工具，不想去买/破解<code>xmind</code>可以使用百度出的<a href="http://naotu.baidu.com" target="_blank" rel="noopener">百度脑图</a>来画思维导图。</li>
</ul>
<h3 id="按上面的分类来分别介绍"><a href="#按上面的分类来分别介绍" class="headerlink" title="按上面的分类来分别介绍"></a>按上面的分类来分别介绍</h3><h4 id="HTML文档标签"><a href="#HTML文档标签" class="headerlink" title="HTML文档标签"></a>HTML文档标签</h4><ol>
<li><code>&lt;!DOCTYPE&gt;</code>：定义文档类型。</li>
<li><code>&lt;html&gt;</code>： 定义HTML文档。</li>
<li><code>&lt;head&gt;</code>：定义文档的头部。<ol>
<li><code>&lt;meta&gt;</code>：定义元素可提供的有关页面的元信息，比如针对搜索引擎和更新频度的描述和关键字。</li>
<li><code>&lt;base&gt;</code>：定义页面上的所有链接规定默认地址或默认目标。</li>
<li><code>&lt;title&gt;</code>：定义文档标题。</li>
<li><code>&lt;link&gt;</code>：定义文档与外部资源的关系。</li>
<li><code>&lt;style&gt;</code>：定义HTML文档样式信息。</li>
</ol>
</li>
<li><code>&lt;body&gt;</code>：定义文档的主体。（脚本在非必需情况时在<body>的最后）<ol>
<li><code>&lt;script&gt;</code>：定义客户端脚本，比如<code>javascript</code>。</li>
<li><code>&lt;noscript&gt;</code>：定义脚本未被执行时的替代内容。（如文本）</li>
</ol>
</body></li>
</ol>
<h4 id="按闭合特征分类"><a href="#按闭合特征分类" class="headerlink" title="按闭合特征分类"></a>按闭合特征分类</h4><h5 id="闭合标签："><a href="#闭合标签：" class="headerlink" title="闭合标签："></a>闭合标签：</h5><ul>
<li>闭合标签是指由开始标签和结束标签组成的一对标签，这种标签允许嵌套和承载内容，例如<code>&lt;html&gt;&lt;/html&gt;、&lt;p&gt;&lt;/p&gt;</code>等。</li>
</ul>
<h5 id="空标签："><a href="#空标签：" class="headerlink" title="空标签："></a>空标签：</h5><ul>
<li>空标签是指没有内容的标签，在开始标签中自动闭合。常见的空标签有：<code>&lt;br&gt;、&lt;hr&gt;、 &lt;img&gt;、 &lt;input&gt;、 &lt;link&gt; &lt;meta&gt;</code>。</li>
</ul>
<h4 id="按是否换行特征分类"><a href="#按是否换行特征分类" class="headerlink" title="按是否换行特征分类"></a>按是否换行特征分类</h4><h5 id="块级元素："><a href="#块级元素：" class="headerlink" title="块级元素："></a>块级元素：</h5><ul>
<li>块级元素是指本身的属性为<code>display:block</code>的元素。因为他自身的特点，我们通常使用块级元素来进行大布局（大结构）的搭建。</li>
<li>块级元素的特点：<ol>
<li>每个块级元素独占一行，每个块级元素都会从新的一行开始，从上到下排布。</li>
<li>块级元素可以直接控制宽度、高度以及盒子模型的相关css属性。</li>
<li>在不设置宽度的情况下，块级元素的宽度是他父级元素内容的宽度。</li>
<li>在不设置高度的情况下，块级元素的高度是他本身内容的高度。</li>
</ol>
</li>
<li>常见块级元素：</li>
</ul>
<table>
<thead>
<tr>
<th>标签</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>div</td>
<td>常用块级容器，也是css和layout的主要标签</td>
</tr>
<tr>
<td>h1、h2、h3</td>
<td>一、二、三级标题</td>
</tr>
<tr>
<td>h4、h5、h6</td>
<td>四、五、六级标题</td>
</tr>
<tr>
<td>hr</td>
<td>水平分隔线</td>
</tr>
<tr>
<td>menu</td>
<td>菜单列表</td>
</tr>
<tr>
<td>ol、ul、li</td>
<td>有序列表、无序列表、列表项</td>
</tr>
<tr>
<td>dl、dt、dd</td>
<td>定义列表、定义术语、定义描述</td>
</tr>
<tr>
<td>table</td>
<td>表格</td>
</tr>
<tr>
<td>p</td>
<td>段落</td>
</tr>
<tr>
<td>form</td>
<td>交互表单</td>
</tr>
</tbody>
</table>
<h5 id="内联元素"><a href="#内联元素" class="headerlink" title="内联元素"></a>内联元素</h5><ul>
<li>内联元素是指本身属性为<code>display:inline</code>的元素，其宽度随元素的内容而变化。因为他自身的特点，我们通常使用内联元素来进行文字、小图片（小结构）的搭建。</li>
<li>内联元素的特点：<ol>
<li>内联元素会和其他元素从左到右显示在一行。</li>
<li><strong>内联元素不能直接控制宽度、高度以及盒子模型的相关css属性，但是可以设置内外边距的水平方向的值。也就是说对于内联元素的<code>margin</code>和<code>padding</code>，只有<code>margin-left/margin-right</code>和<code>padding-left/padding-right</code>是有效的，但是竖直方向的<code>margin</code>和<code>padding</code>无效果。</strong></li>
<li>内联元素的宽高是由内容本身的大小决定的（文字、图片等）。</li>
<li>内联元素只能容纳文本或者其他内联元素（不要在内联元素中嵌套块级元素）。</li>
</ol>
</li>
<li>常见的内联元素：</li>
</ul>
<table>
<thead>
<tr>
<th>标签</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>a</td>
<td>锚点</td>
</tr>
<tr>
<td>b</td>
<td>加粗</td>
</tr>
<tr>
<td>span</td>
<td>常用的内联容器，定义文本内区块</td>
</tr>
<tr>
<td>img</td>
<td>引入图片</td>
</tr>
<tr>
<td>input</td>
<td>输入框</td>
</tr>
<tr>
<td>select</td>
<td>下拉列表</td>
</tr>
<tr>
<td>strong</td>
<td>加粗强调</td>
</tr>
<tr>
<td>label</td>
<td>Input元素定义标注（标记）</td>
</tr>
</tbody>
</table>
<h4 id="H5新标签"><a href="#H5新标签" class="headerlink" title="H5新标签"></a>H5新标签</h4><h5 id="祭出脑图："><a href="#祭出脑图：" class="headerlink" title="祭出脑图："></a>祭出脑图：</h5><p><img src="http://upload-images.jianshu.io/upload_images/7166236-7416a45973370997.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="H5新标签 (1).png"></p>
<h5 id="然而。。。"><a href="#然而。。。" class="headerlink" title="然而。。。"></a>然而。。。</h5><ul>
<li>h5新特性感觉面试比问，但是记住所有是不可能的，也不切实际。把几个主要的新标签记住，讲清楚应该就差不多了吧。</li>
</ul>
<table>
<thead>
<tr>
<th>标签</th>
<th>描述</th>
</tr>
</thead>
<tbody>
<tr>
<td>time</td>
<td>定义日期或时间</td>
</tr>
<tr>
<td>progress</td>
<td>状态标签（任务过程：安装、加载）</td>
</tr>
<tr>
<td>canvas</td>
<td>定义图形，比如图标和其他图像。，canvas作容器，用脚本绘制图形。</td>
</tr>
<tr>
<td>dialog</td>
<td>定义对话框或窗口。</td>
</tr>
<tr>
<td>video</td>
<td>定义视频 ，像电影片段或其他视频流而不用再使用第三方插件。现在主要支持 Ogg 和 MPEG 两种视屏格式。</td>
</tr>
<tr>
<td>audio</td>
<td>定义音频，如音乐或其他音频流。</td>
</tr>
<tr>
<td>keygen</td>
<td>定义表单里一个生产的键值，加密信息传送。</td>
</tr>
</tbody>
</table>
<h4 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h4><h5 id="1-内联元素可以使用padding和margin吗-（别人的面试题）"><a href="#1-内联元素可以使用padding和margin吗-（别人的面试题）" class="headerlink" title="1. 内联元素可以使用padding和margin吗?（别人的面试题）"></a>1. 内联元素可以使用padding和margin吗?（别人的面试题）</h5><ul>
<li>答：对于内联元素的<code>margin</code>和<code>padding</code>，只有<code>margin-left/margin-right</code>和<code>padding-left/padding-right</code>是有效的，但是竖直方向的<code>margin</code>和<code>padding</code>无效果。但是内联元素父级设置的<code>padding</code>对内联元素是有作用的。举个小例子：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"height: 300px;width: 300px"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--此处的margin、padding只有水平方向有效--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">"padding: 50px; margin: 50px"</span>&gt;</span>helloworld<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--在父级节点设置的margin，对于嵌套的内联元素，也只是水平方向有效果--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 200px;height: 200px;background-color: cyan;margin: 50px"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>helloworld<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"height: 300px;width: 300px"</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--在父级节点设置的padding，对于嵌套的内联元素，水平和垂直方向都有效果--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 200px;height: 200px;background-color: cyan;padding: 50px"</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>helloworld<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>效果如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-d76924394a71f427.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h5 id="2-如何让2个元素在同一行？"><a href="#2-如何让2个元素在同一行？" class="headerlink" title="2. 如何让2个元素在同一行？"></a>2. 如何让2个元素在同一行？</h5><p>这是个有趣的问题，应该有不少人搜过，我也搜过。出现这个问题主要还是滥用块级元素，或者是不会使用一些小技巧。举个例子，有时候我们想实现如下表单效果：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name2"</span>&gt;</span>姓名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name2"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入姓名"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-de50875980b4f781.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>但有时候写着写着会变成下面的样子：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-0b436315bb10614c.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>按我从以前遇到过情况来说，出现上面的情况的原因，可能有2个：</p>
<p><strong>第一，就是可能在某个地方<label>被设置块级元素包住了</label></strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name1"</span>&gt;</span>姓名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name1"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入姓名"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>解决方法：</strong>在外部样式使用<code>display: inline-block</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"display: inline-block"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name1"</span>&gt;</span>姓名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name1"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入姓名"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>第二，就是<label>的样式使用了 <code>display: block</code></label></strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name2"</span> <span class="attr">style</span>=<span class="string">"display: block"</span>&gt;</span>姓名：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">id</span>=<span class="string">"name2"</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">placeholder</span>=<span class="string">"请输入姓名"</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>所以如果以后在写表单的时候，出现这个问题，可以从上面2个方向去查找原因，以及找出相应的解决方法。</p>
<h5 id="lt-Doctype-gt-确定浏览器使用何种模式渲染"><a href="#lt-Doctype-gt-确定浏览器使用何种模式渲染" class="headerlink" title="&lt;!Doctype&gt; 确定浏览器使用何种模式渲染"></a><code>&lt;!Doctype&gt;</code> 确定浏览器使用何种模式渲染</h5><p>（1）、&lt;!DOCTYPE&gt;声明位于位于HTML文档中的第一行，处于 <html> 标签之前。告知浏览器的解析器用什么文档标准解析这个文档。DOCTYPE不存在或格式不正确会导致文档以兼容模式呈现。使用<code>&lt;!Doctype&gt;</code>会让文档中的所有盒子模型以w3c标准盒子模型呈现。</html></p>
<p>（2）、标准模式的排版 和JS运作模式都是以该浏览器支持的最高标准运行。在兼容模式中，页面以宽松的向后兼容的方式显示,模拟老式浏览器的行为以防止站点无法工作。</p>
<h5 id="标准模式和怪异模式的来由"><a href="#标准模式和怪异模式的来由" class="headerlink" title="标准模式和怪异模式的来由"></a>标准模式和怪异模式的来由</h5><p>在HTML与CSS的标准化未完成之前，各个浏览器对于HTML和CSS的解析有各自不同的实现，而有很多旧的网页都是按照这些非标准的实现去设计的。在HTML与CSS标准确定之后，浏览器一方面要按照标准去实现对HTML与CSS的支持，另一方面又要保证对非标准的旧网页设计的后向兼容性。因此，现代的浏览器一般都有两种渲染模式：<strong>标准模式</strong>和<strong>怪异模式</strong>。在<strong>标准模式</strong>下，浏览器按照HTML与CSS标准对文档进行解析和渲染；而在<strong>怪异模式</strong>下，浏览器则按照旧有的非标准的实现方式对文档进行解析和渲染。这样的话，对于旧有的网页，浏览器启动怪异模式，就能够使得旧网页正常显示；对于新的网页，则可以启动标准模式，使得新网页能够使用HTML与CSS的标准特性。</p>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><p><a href="http://www.cnblogs.com/starof/p/4581850.html" target="_blank" rel="noopener">Reference1 - h5新增标签</a></p>
<p><a href="http://blog.csdn.net/Ultranana/article/details/61423879" target="_blank" rel="noopener">Reference2 - HTML元素分类</a></p>
<p><a href="http://www.zhufengpeixun.com/qianduanjishuziliao/qianduanCSSziliao/2016-06-29/456.html" target="_blank" rel="noopener">Reference3 - html标签分类及常用元素</a></p>
<p><a href="https://segmentfault.com/a/1190000003826215" target="_blank" rel="noopener">Reference4 - HTML5常用标签分类</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/02/05/ng2-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/05/ng2-4/" itemprop="url">Angular2-基于动态创建组件的可配置表单设计</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-05T00:30:28+08:00">
                2018-02-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web框架/" itemprop="url" rel="index">
                    <span itemprop="name">web框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h3 id="需求"><a href="#需求" class="headerlink" title="需求"></a>需求</h3><ul>
<li>提供给管理员配置简历表单的功能。</li>
<li>基本思路：将一个个表单项做成组件（例如输入框，单选框，复选框，图片，文件，日期等），每个组件对应一段固定的<code>json</code>（包括组件名，<code>placeholder</code>，选项个数，字数限制等等），方便存储。每增加一项就向<code>json</code>数组中增加一个元素，然后把这段<code>json</code>存到后端。每个应聘者的简历其实就是一份<code>json</code>，查看的时候根据这段<code>json</code>利用动态创建的方式渲染出来。</li>
</ul>
<h3 id="动态创建"><a href="#动态创建" class="headerlink" title="动态创建"></a>动态创建</h3><p>​    Angular提供了<a href="https://angular.io/api/core/ComponentFactoryResolver" target="_blank" rel="noopener"><code>ComponentFactoryResolver</code></a>，来协助我们在程序中动态产生不同的组件，而不用死板地把所有的组件都写到<code>view</code>中去，再根据条件判断是否要显示某个组件，当遇到呈现的方式比较复杂的需求时非常好用，写出来的代码也会简洁，好看很多。例如可配置表单（简历，问卷），还有滚动广告等。</p>
<h4 id="开始之前，先介绍几个对象"><a href="#开始之前，先介绍几个对象" class="headerlink" title="开始之前，先介绍几个对象"></a>开始之前，先介绍几个对象</h4><ol>
<li><code>ViewChild</code>：一个属性装饰器，用来从模板视图中获取对应的元素，可以通过模板变量获取，获取时可以通过 read 属性设置查询的条件，就是说可以把此视图转为不同的实例。</li>
<li><code>ViewContainerRef</code>：一个视图容器，可以在此上面创建、插入、删除组件等等。</li>
<li><code>ComponentFactoryResolve</code>：一个服务，动态加载组件的核心，这个服务可以将一个组件实例呈现到另一个组件视图上。</li>
<li><code>entryComponents</code>：这个数组是用<code>ViewContainerRef.createComponent（）</code>添加的动态添加的组件。将它们添加到<code>entryComponents</code>是告诉编译器编译它们并为它们创建<code>Factory</code>。路由配置中注册的组件也自动添加到<code>entryComponents</code>，因为<code>router-outlet</code>也使用<code>ViewContainerRef.createComponent（）</code>将路由组件添加到DOM。</li>
</ol>
<ul>
<li>有了上面，一个简单的思路便连贯了：特定区域就是一个视图容器，可以通过 <code>ViewChild</code>来实现获取和查询，然后使用<code>ComponentFactoryResolve</code>将已声明未实例化的组件解析成为可以动态加载的 <code>component</code>，再将此<code>component</code>呈现到此前的视图容器中。</li>
</ul>
<h4 id="1-建立DynamicComponentDirective"><a href="#1-建立DynamicComponentDirective" class="headerlink" title="1. 建立DynamicComponentDirective"></a>1. 建立<code>DynamicComponentDirective</code></h4><p>​    首先先建立一个<code>directive</code>，并注入<code>ViewContainerRef</code>，<code>ViewContainerRef</code>是一个视图容器，可以在此上面创建、插入、删除组件等等，代码如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// DynamicComponentDirective.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;Directive, ViewContainerRef&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Directive</span>(&#123;</span><br><span class="line">  selector: <span class="string">'[dynamicComponent]'</span></span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> DynamicComponentDirective &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"><span class="keyword">public</span> viewContainerRef: ViewContainerRef</span>) &#123; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>​    接着套用这个<code>directive</code>到需要动态加载的组件的容器上，简单套用<code>&lt;ng-template&gt;</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--动态产生组件的容器--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">ng-template</span> <span class="attr">dynamicComponent</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="2-使用ComponentFactoryResolver动态产生组件"><a href="#2-使用ComponentFactoryResolver动态产生组件" class="headerlink" title="2. 使用ComponentFactoryResolver动态产生组件"></a>2. 使用<code>ComponentFactoryResolver</code>动态产生组件</h4><p>​    直接看代码，都加了注释。</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;Component, ComponentFactoryResolver, ViewChild&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;DynamicComponentDirective&#125; <span class="keyword">from</span> <span class="string">'./DynamicComponentDirective'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;SampleComponent&#125; <span class="keyword">from</span> <span class="string">'./sample/sample.component'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-root'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./app.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./app.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppComponent &#123;</span><br><span class="line">  <span class="comment">// 使用ViewChild取得要动态放置Component的directive(componentHost)</span></span><br><span class="line">  <span class="meta">@ViewChild</span>(DynamicComponentDirective) componentHost: DynamicComponentDirective;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="comment">// 注入ComponentFactoryResolver</span></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> componentFactoryResolver: ComponentFactoryResolver</span></span><br><span class="line"><span class="params">  </span>) &#123; &#125;</span><br><span class="line">  title = <span class="string">'动态创建组件样例'</span>;</span><br><span class="line">  createNewComponent() &#123;</span><br><span class="line">    <span class="comment">// 建立ComponentFactory</span></span><br><span class="line">    <span class="keyword">const</span> componentFactory = <span class="keyword">this</span>.componentFactoryResolver.resolveComponentFactory(SampleComponent);</span><br><span class="line">    <span class="keyword">const</span> viewContainerRef = <span class="keyword">this</span>.componentHost.viewContainerRef;</span><br><span class="line">    <span class="comment">// 产生我们需要的Component并放入componentHost之中</span></span><br><span class="line">    viewContainerRef.createComponent(componentFactory);</span><br><span class="line">    <span class="comment">// const componentRef = viewContainerRef.createComponent(componentFactory);</span></span><br><span class="line">  &#125;</span><br><span class="line">  clearView() &#123;</span><br><span class="line">    <span class="keyword">const</span> viewContainerRef = <span class="keyword">this</span>.componentHost.viewContainerRef;</span><br><span class="line">    viewContainerRef.clear();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"text-align:center"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line">    &#123;&#123; title &#125;&#125;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--动态产生组件的容器--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ng-template</span> <span class="attr">dynamicComponent</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"createNewComponent()"</span>&gt;</span>动态创建组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"clearView()"</span>&gt;</span>清除视图<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="3-在Module中加入entryComponents"><a href="#3-在Module中加入entryComponents" class="headerlink" title="3. 在Module中加入entryComponents"></a>3. 在<code>Module</code>中加入<code>entryComponents</code></h4><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123; BrowserModule &#125; <span class="keyword">from</span> <span class="string">'@angular/platform-browser'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; NgModule &#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; AppComponent &#125; <span class="keyword">from</span> <span class="string">'./app.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; SampleComponent &#125; <span class="keyword">from</span> <span class="string">'./sample/sample.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;DynamicComponentDirective&#125; <span class="keyword">from</span> <span class="string">'./DynamicComponentDirective'</span>;</span><br><span class="line"><span class="meta">@NgModule</span>(&#123;</span><br><span class="line">  declarations: [</span><br><span class="line">    AppComponent,</span><br><span class="line">    SampleComponent,</span><br><span class="line">    DynamicComponentDirective</span><br><span class="line">  ],</span><br><span class="line">  imports: [</span><br><span class="line">    BrowserModule</span><br><span class="line">  ],</span><br><span class="line">  entryComponents: [</span><br><span class="line">    SampleComponent</span><br><span class="line">  ],</span><br><span class="line">  providers: [],</span><br><span class="line">  bootstrap: [AppComponent]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppModule &#123; &#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-效果展示"><a href="#4-效果展示" class="headerlink" title="4. 效果展示"></a>4. 效果展示</h4><p><img src="http://upload-images.jianshu.io/upload_images/7166236-e6d99b4b75040751.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>有了以上知识铺垫，可以进入下一阶段。</p>
<h3 id="动态创建表单与表单的渲染"><a href="#动态创建表单与表单的渲染" class="headerlink" title="动态创建表单与表单的渲染"></a>动态创建表单与表单的渲染</h3><ul>
<li>要实现的效果如下：</li>
</ul>
<ol>
<li>动态创建一个组件，生成一段<code>json</code>。</li>
<li>根据<code>json</code>数组生成表单。</li>
</ol>
<h4 id="动态创建组件："><a href="#动态创建组件：" class="headerlink" title="动态创建组件："></a>动态创建组件：</h4><p><img src="http://upload-images.jianshu.io/upload_images/7166236-fbddee133f5bcc83.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h4 id="点击保存模板，保存json，根据json重新渲染表单："><a href="#点击保存模板，保存json，根据json重新渲染表单：" class="headerlink" title="点击保存模板，保存json，根据json重新渲染表单："></a>点击保存模板，保存json，根据json重新渲染表单：</h4><p><img src="http://upload-images.jianshu.io/upload_images/7166236-5e2dfe31fd6e0252.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h4 id="具体步骤如下："><a href="#具体步骤如下：" class="headerlink" title="具体步骤如下："></a>具体步骤如下：</h4><h5 id="1-以输入框为例，定义json格式"><a href="#1-以输入框为例，定义json格式" class="headerlink" title="1. 以输入框为例，定义json格式"></a>1. 以输入框为例，定义<code>json</code>格式</h5><figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// FormJson.ts</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> FormJson &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> basedata: <span class="built_in">any</span> = &#123;</span><br><span class="line">    name : <span class="string">''</span>,                   <span class="comment">// 子项名称</span></span><br><span class="line">    id : <span class="string">''</span>,</span><br><span class="line">    hintText : <span class="string">''</span>,               <span class="comment">// 子选项提示</span></span><br><span class="line">    <span class="keyword">type</span> : <span class="string">''</span>,                   <span class="comment">// 组件类型</span></span><br><span class="line">    numberLimit : <span class="string">''</span>,            <span class="comment">// 字数限制</span></span><br><span class="line">    content : [],                <span class="comment">// 存放用户填写信息</span></span><br><span class="line">  &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="2-创建可配置组件（以输入框为例）"><a href="#2-创建可配置组件（以输入框为例）" class="headerlink" title="2. 创建可配置组件（以输入框为例）"></a>2. 创建可配置组件（以输入框为例）</h5><p>执行<code>ng -g component input</code>新建一个组件，代码如下：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--input.component.html--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--显示模板--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"input"</span>&gt;</span>&#123;&#123;item.name&#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">    <span class="attr">id</span>=<span class="string">"input"</span></span></span><br><span class="line"><span class="tag">    [(<span class="attr">ngModel</span>)]=<span class="string">"item.content"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">type</span>=<span class="string">"&#123;&#123;item.type&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">    <span class="attr">placeholder</span>=<span class="string">"&#123;&#123;item.hintText&#125;&#125;"</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//input.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;Component, Input, OnInit&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-input'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./input.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./input.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> InputComponent <span class="keyword">implements</span> OnInit &#123;</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123; &#125;</span><br><span class="line">  <span class="comment">// 接收管理员配置的参数</span></span><br><span class="line">  <span class="meta">@Input</span>() item: <span class="built_in">any</span>;</span><br><span class="line">  ngOnInit() &#123;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h5 id="3-动态创建表单"><a href="#3-动态创建表单" class="headerlink" title="3. 动态创建表单"></a>3. 动态创建表单</h5><p>基本操作与动态创建组件是一样的，每创建一个新的表单项，<code>formJson</code>数组就增加一个元素，这里存储表单模板用的是<code>json</code>，所以渲染的时候要根据<code>type</code>来判断要创建什么组件，当然我这里只做了个输入框，只做示例，其他的组件可以举一反三。代码解析如下：</p>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// app.component.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;Component, ComponentFactoryResolver, ViewChild&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;DynamicComponentDirective&#125; <span class="keyword">from</span> <span class="string">'./share/DynamicComponentDirective'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;SampleComponent&#125; <span class="keyword">from</span> <span class="string">'./sample/sample.component'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;FormJson&#125; <span class="keyword">from</span> <span class="string">'./share/FormJson'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;InputComponent&#125; <span class="keyword">from</span> <span class="string">'./input/input.component'</span>;</span><br><span class="line"><span class="meta">@Component</span>(&#123;</span><br><span class="line">  selector: <span class="string">'app-root'</span>,</span><br><span class="line">  templateUrl: <span class="string">'./app.component.html'</span>,</span><br><span class="line">  styleUrls: [<span class="string">'./app.component.css'</span>]</span><br><span class="line">&#125;)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> AppComponent &#123;</span><br><span class="line">  <span class="comment">// 使用ViewChild取得要动态放置Component的directive(componentHost)</span></span><br><span class="line">  <span class="meta">@ViewChild</span>(DynamicComponentDirective) componentHost: DynamicComponentDirective;</span><br><span class="line">  <span class="keyword">public</span> baseData = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(FormJson.basedata));</span><br><span class="line">  <span class="keyword">public</span> formJson = [];</span><br><span class="line">  <span class="keyword">public</span> save = <span class="literal">false</span>;          <span class="comment">// 模拟根据后端json重新加载表单</span></span><br><span class="line">  <span class="keyword">public</span> formJsonText: <span class="built_in">string</span>; <span class="comment">// json文本</span></span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="comment">// 注入ComponentFactoryResolver</span></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> componentFactoryResolver: ComponentFactoryResolver</span></span><br><span class="line"><span class="params">  </span>) &#123; &#125;</span><br><span class="line">  <span class="comment">// 动态创建组件</span></span><br><span class="line">  createInputComponent() &#123;</span><br><span class="line">    <span class="comment">// 示例类型都是文本输入框，所以type字段都置为 text</span></span><br><span class="line">    <span class="keyword">this</span>.baseData.type = <span class="string">'text'</span>;</span><br><span class="line">    <span class="comment">// 将json插入，完成之后可存到后端</span></span><br><span class="line">    <span class="keyword">this</span>.formJson.push(<span class="keyword">this</span>.baseData);</span><br><span class="line">    <span class="comment">// 页面显示json</span></span><br><span class="line">    <span class="keyword">this</span>.formJsonText = <span class="built_in">JSON</span>.stringify(<span class="keyword">this</span>.formJson);</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.formJson);</span><br><span class="line">    <span class="comment">// 清除旧预览</span></span><br><span class="line">    <span class="keyword">this</span>.componentHost.viewContainerRef.clear();</span><br><span class="line">    <span class="comment">// 渲染新示例页面</span></span><br><span class="line">    <span class="keyword">this</span>.createForm(<span class="keyword">this</span>.formJson);</span><br><span class="line">    <span class="comment">// 将json元素赋空，方便下次创建</span></span><br><span class="line">    <span class="keyword">this</span>.baseData = <span class="built_in">JSON</span>.parse(<span class="built_in">JSON</span>.stringify(FormJson.basedata));</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 根据json动态创建表单</span></span><br><span class="line">  createForm(formJson) &#123;</span><br><span class="line">    <span class="keyword">const</span> inputComponentFactory = <span class="keyword">this</span>.componentFactoryResolver.resolveComponentFactory(InputComponent);</span><br><span class="line">    <span class="comment">// 遍历json 根据不同类型创建组件，可扩充</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span> ; i &lt; formJson.length ; i++) &#123;</span><br><span class="line">      <span class="keyword">const</span> item = formJson[i] ;</span><br><span class="line">      <span class="keyword">let</span> componentRef;</span><br><span class="line">      <span class="keyword">switch</span> (item.type) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">'text'</span>:</span><br><span class="line">          componentRef = <span class="keyword">this</span>.componentHost.viewContainerRef.createComponent(inputComponentFactory);</span><br><span class="line">          componentRef.instance.componentRef = componentRef;  <span class="comment">// 传入自身组件引用，用于返回来编辑自身</span></span><br><span class="line">          componentRef.instance.item = item;                  <span class="comment">// 将管理员配置数据传进组件渲染</span></span><br><span class="line">          <span class="keyword">break</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  saveForm() &#123;</span><br><span class="line">    <span class="keyword">this</span>.componentHost.viewContainerRef.clear();</span><br><span class="line">    <span class="comment">// todo 将表单模板存到后端</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.formJson);</span><br><span class="line">    <span class="keyword">this</span>.save = <span class="literal">true</span>;</span><br><span class="line">    setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// todo 根据json重新解析，其实就像预览一样，调用createForm</span></span><br><span class="line">      <span class="comment">// 延时3s查看效果，便于理解</span></span><br><span class="line">      <span class="keyword">this</span>.createForm(<span class="keyword">this</span>.formJson);</span><br><span class="line">    &#125;, <span class="number">3000</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 300px; float: left;height: 400px"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>示例：创建自定义输入框<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"name"</span>&gt;</span>输入框名字:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">      <span class="attr">id</span>=<span class="string">"name"</span></span></span><br><span class="line"><span class="tag">      [(<span class="attr">ngModel</span>)]=<span class="string">"baseData.name"</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"placeholder"</span>&gt;</span>输入框提示:<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">id</span>=<span class="string">"placeholder"</span></span></span><br><span class="line"><span class="tag">        [(<span class="attr">ngModel</span>)]=<span class="string">"baseData.hintText"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span> <span class="attr">style</span>=<span class="string">"margin: 10px"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"createInputComponent()"</span>&gt;</span>动态创建组件<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 300px;margin-left: 500px;height: 400px"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">p</span> *<span class="attr">ngIf</span>=<span class="string">"save === false"</span>&gt;</span>示例：预览<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> *<span class="attr">ngIf</span>=<span class="string">"save"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>--------JSON重新转化为表单-----------<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">p</span>&gt;</span>--------延时让效果更明显-----------<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ng-template</span> <span class="attr">dynamicComponent</span>&gt;</span><span class="tag">&lt;/<span class="name">ng-template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin: 10px"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">button</span> (<span class="attr">click</span>)=<span class="string">"saveForm()"</span>&gt;</span>保存模板<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 500px;height: 400px"</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span> &gt;</span>打印JSON<span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"margin: 10px"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">textarea</span> [(<span class="attr">ngModel</span>)] = <span class="string">"formJsonText"</span> <span class="attr">rows</span>=<span class="string">"30"</span> <span class="attr">style</span>=<span class="string">"width: 500px"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h5 id="操作演示："><a href="#操作演示：" class="headerlink" title="操作演示："></a>操作演示：</h5><ul>
<li>动态创建一个组件</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-5042dab2f69aabc0.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>观察预览和son输出</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-d2c4d49b32bab25e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>点击生成模板，根据json重新渲染组件</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-0fa740fe6dd094d4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="最后"><a href="#最后" class="headerlink" title="最后"></a>最后</h3><h4 id="源码地址-gt-Demo"><a href="#源码地址-gt-Demo" class="headerlink" title="源码地址-&gt;Demo"></a>源码地址-&gt;<a href="https://github.com/Husbin/web/tree/master/DynamicComponent" target="_blank" rel="noopener">Demo</a></h4><h4 id="在线示例-gt-在线demo"><a href="#在线示例-gt-在线demo" class="headerlink" title="在线示例-&gt;在线demo"></a>在线示例-&gt;<a href="http://119.23.214.114:8889" target="_blank" rel="noopener">在线demo</a></h4><p>​    这只是我个人对项目中的用法的总结，欢迎大家指正与交流。还有就是demo只是个demo，我并没有花时间去做检查、控制之类的，所以有bug很正常。。</p>
<h4 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h4><ol>
<li><a href="https://dotblogs.com.tw/wellwind/2017/06/21/dynamic-component-with-component-factory-resolver" target="_blank" rel="noopener">reference – 使用ComponentFactoryResolver动态产生Component</a></li>
<li><a href="https://www.jianshu.com/p/10feab2c3102" target="_blank" rel="noopener">reference – angular2(4) 中动态创建组件的两种方案</a></li>
</ol>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/02/02/the-first-day/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/02/the-first-day/" itemprop="url">搭建的第一天</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-02T15:22:02+08:00">
                2018-02-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/琐言碎语/" itemprop="url" rel="index">
                    <span itemprop="name">琐言碎语</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>看到朋友的<code>Material</code>主题的个人博客，有点羡慕，就自己动手搭了个。本来以前也有做笔记的习惯，有道云笔记，csdn博客，还有现在在写的简书，简书还是挺好用的 。 但是想想身为一个打算走前端的人，有个个人博客才显得专业一点。</p>
<h2 id="笔记历程"><a href="#笔记历程" class="headerlink" title="笔记历程"></a>笔记历程</h2><h3 id="csdn"><a href="#csdn" class="headerlink" title="csdn"></a>csdn</h3><ul>
<li>主要是大一写的，现在想想写得都有点幼稚。<a href="http://blog.csdn.net/qq_34174814" target="_blank" rel="noopener">csdn</a>               逃）</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-8938bc2440abfbc6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="简书"><a href="#简书" class="headerlink" title="简书"></a>简书</h3><ul>
<li>简书是我打算开始做前端之后开始写的，但是因为很长一段时间在做项目，所以总结得不多。以后这个博客和简书会同步更新。<a href="https://www.jianshu.com/u/8dad13d2b0fb" target="_blank" rel="noopener">前往简书</a></li>
</ul>
<h3 id="关于迁移"><a href="#关于迁移" class="headerlink" title="关于迁移"></a>关于迁移</h3><ul>
<li>我会把简书上的笔记总结按照时间顺序搬到这边。</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/02/02/js-4/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/02/js-4/" itemprop="url">javascript垃圾回收与内存泄漏</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-02T10:05:18+08:00">
                2018-02-02
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="垃圾回收机制"><a href="#垃圾回收机制" class="headerlink" title="垃圾回收机制"></a>垃圾回收机制</h2><h3 id="自动垃圾收集机制"><a href="#自动垃圾收集机制" class="headerlink" title="自动垃圾收集机制"></a>自动垃圾收集机制</h3><ul>
<li>javascript具有自动垃圾收集机制，也就是说，执行环境会负责管理代码执行过程中使用的内存。即开发人员不需要当心内存使用的问题，所需内存的分配以及无用内存的回收完全实现了自动管理。这种垃圾回收机制的原理：找出那些不再继续使用的变量，然后释放其内存。为此，垃圾收集器会按照固定的时间间隔，周期性地执行这一操作。</li>
</ul>
<h3 id="局部变量的生命周期"><a href="#局部变量的生命周期" class="headerlink" title="局部变量的生命周期"></a>局部变量的生命周期</h3><ul>
<li>局部变量只在函数执行的过程中存在。在这个过程中，会为局部变量在栈内存或堆内存上分配相应的空间，以便存储他们的值。然后再函数中使用这些变量，直至函数执行结束。此时，局部变量就没有存在的必要了，因此可以释放他们的内存以供将来使用。</li>
</ul>
<h3 id="javascript中的2种垃圾回收机制"><a href="#javascript中的2种垃圾回收机制" class="headerlink" title="javascript中的2种垃圾回收机制"></a>javascript中的2种垃圾回收机制</h3><h4 id="标记清除（Mark-and-sweep）"><a href="#标记清除（Mark-and-sweep）" class="headerlink" title="标记清除（Mark-and-sweep）"></a>标记清除（Mark-and-sweep）</h4><ul>
<li>包括标记阶段和清除阶段。</li>
<li><strong>标记阶段：</strong>垃圾回收器创建了一个<code>roots</code>列表。<code>Roots</code>通常是代码中全局变量的引用。javascript中，<strong><code>window</code>对象是一个全局变量，被当作<code>root</code></strong>。<code>window</code>对象总是存在，因此垃圾回收器可以检查他和他所有子对象是否存在（即不是垃圾）。所有的<code>roots</code>被检查和标记为激活（即不是垃圾）。<strong>所有的子对象也被递归检查，检查从<code>root</code>开始的所有对象，如果是可达的，则打上标记</strong>。标记阶段到此结束。</li>
<li><strong>清除阶段：</strong>标记阶段完成时，被标记的对象被视为“存活”对象。<strong>然后重新进入递归扫描阶段，将没有标记的对象进行回收</strong>。这一阶段称为清除阶段。在扫描的同时，还需要将存活的对象的标记清除掉，以便下一次GC操作做准备。</li>
</ul>
<h4 id="引用计数（reference-counting）"><a href="#引用计数（reference-counting）" class="headerlink" title="引用计数（reference counting）"></a>引用计数（reference counting）</h4><ul>
<li>引用计数的含义是跟踪记录每个值被引用的次数。当声明了一个变量并将一个引用类型赋给该变量时，则这个值的引用次数就是1。如果同一个值又被赋给另一个变量，则将该引用次数再加1。相反，如果包含对这个值得引用变量又取得了另一个值，则这个值的引用次数就减1。当这个值得引用次数变为0时，则说明没有办法在访问这个值了，因而久可以将其占用的内存空间回收回来。这样，垃圾回收器下次再运行时，会释放那些引用次数为0的值所占用的内存。</li>
</ul>
<h2 id="内存泄漏"><a href="#内存泄漏" class="headerlink" title="内存泄漏"></a>内存泄漏</h2><ul>
<li>内存泄漏是指应用程序使用过的内存片段，在不需要的时候，不能返回到操作系统或可用的内存池中的情况。javascript中的内存泄漏同理，当一个值不再需要被引用了，但却无法被垃圾回收器回收的情况，就是内存泄露。</li>
</ul>
<h3 id="javascript中3种常见的内存泄漏"><a href="#javascript中3种常见的内存泄漏" class="headerlink" title="javascript中3种常见的内存泄漏"></a>javascript中3种常见的内存泄漏</h3><h4 id="1-意外的全局变量"><a href="#1-意外的全局变量" class="headerlink" title="1. 意外的全局变量"></a>1. 意外的全局变量</h4><p>举个例子(普通变量)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">fun</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  globalVar = <span class="string">"this is a hidden global variable"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在函数体内部定义变量，如果没有使用var声明，则定义的变量是全局变量，即成为window的一个属性</span></span><br><span class="line"><span class="comment">//而window总是存在，因此不会被回收</span></span><br></pre></td></tr></table></figure>
<p>再举个例子(由this创建的变量)：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">this</span>.variable = <span class="string">"potential accidental global"</span>;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>)</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Foo 调用自己，this 指向了全局对象（window）</span></span><br><span class="line"><span class="comment">// 而不是 undefined</span></span><br><span class="line">foo();</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-7832efc32cf22d18.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li><strong>解决方案：</strong>在js文件头部加上（ES5）<code>use strict</code>，使用严格模式，可以避免此类错误的发生。如果必须使用全局变量存储大量数据时，确保用完以后把它设置为 null 或者重新定义。</li>
</ul>
<h4 id="2-被遗忘的计数器或者回调函数"><a href="#2-被遗忘的计数器或者回调函数" class="headerlink" title="2.被遗忘的计数器或者回调函数"></a>2.被遗忘的计数器或者回调函数</h4><p>举个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> someResource = getData();</span><br><span class="line">setInterval(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> node = <span class="built_in">document</span>.getElementById(<span class="string">'Node'</span>);</span><br><span class="line">    <span class="keyword">if</span>(node) &#123;</span><br><span class="line">        <span class="comment">// 处理 node 和 someResource</span></span><br><span class="line">        node.innerHTML = <span class="built_in">JSON</span>.stringify(someResource));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;, <span class="number">1000</span>);</span><br><span class="line"><span class="comment">//重复计数器并没有使用 clearInterval()终止，导致内存无法回收</span></span><br></pre></td></tr></table></figure>
<ul>
<li>对于观察者的例子，一旦它们不再需要（或者关联的对象变成不可达），明确地移除它们非常重要。老的 IE 6 是无法处理循环引用的。如今，即使没有明确移除它们，一旦观察者对象变成不可达，大部分浏览器是可以回收观察者处理函数的。</li>
</ul>
<h4 id="3-脱离DOM的引用"><a href="#3-脱离DOM的引用" class="headerlink" title="3. 脱离DOM的引用"></a>3. 脱离DOM的引用</h4><ul>
<li>有时，保存 DOM 节点内部数据结构很有用。假如你想快速更新表格的几行内容，把每一行 DOM 存成字典（JSON 键值对）或者数组很有意义。<strong>此时，同样的 DOM 元素存在两个引用：一个在 DOM 树中，另一个在字典中。将来你决定删除这些行时，需要把两个引用都清除</strong>。</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> elements = &#123;</span><br><span class="line">    button: <span class="built_in">document</span>.getElementById(<span class="string">'button'</span>),</span><br><span class="line">    image: <span class="built_in">document</span>.getElementById(<span class="string">'image'</span>),</span><br><span class="line">    text: <span class="built_in">document</span>.getElementById(<span class="string">'text'</span>)</span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">doStuff</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    image.src = <span class="string">'http://some.url/image'</span>;</span><br><span class="line">    button.click();</span><br><span class="line">    <span class="built_in">console</span>.log(text.innerHTML);</span><br><span class="line">    <span class="comment">// 更多逻辑</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">removeButton</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="comment">// 按钮是 body 的后代元素</span></span><br><span class="line">    <span class="built_in">document</span>.body.removeChild(<span class="built_in">document</span>.getElementById(<span class="string">'button'</span>));</span><br><span class="line">    <span class="comment">// 此时，仍旧存在一个全局的 #button 的引用</span></span><br><span class="line">    <span class="comment">// elements 字典所引用的button 元素仍旧在内存中，不能被 GC 回收。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="4-闭包（正常情况下不会造成内存泄漏）"><a href="#4-闭包（正常情况下不会造成内存泄漏）" class="headerlink" title="4.闭包（正常情况下不会造成内存泄漏）"></a>4.闭包（正常情况下不会造成内存泄漏）</h4><blockquote>
<p>闭包就是能够读取其他函数内部变量的函数，闭包的出现时为了突破作用域链的限制。</p>
<p>由于IE9 之前的版本对JScript 对象和COM 对象使用不同的垃圾收集。因此闭包在IE 的这些版本中会导致一些特殊的问题。<strong>具体来说，如果闭包的作用域链中保存着一个HTML 元素，那么就意味着该元素将无法被销毁</strong>。</p>
<p>reference – javascript高级程序设计第三版</p>
</blockquote>
<p>举个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">closure</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">"someElement"</span>);</span><br><span class="line">    element.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(element.id);</span><br><span class="line">    &#125;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>以上代码创建了一个作为element 元素事件处理程序的闭包，而这个闭包则又创建了一个循环引用。由于匿名函数保存了一个对closure()的活动对象的引用，因此就会导致无法减少element 的引用数。只要匿名函数存在，element 的引用数至少也是1，因此它所占用的内存就永远不会被回收。</li>
</ul>
<p><strong>解决方案</strong>：把element.id 的一个副本保存在一个变量中，从而消除闭包中该变量的循环引用同时将element变量设为null。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">closure</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">var</span> element = <span class="built_in">document</span>.getElementById(<span class="string">"someElement"</span>);</span><br><span class="line">    <span class="keyword">var</span> id = element.id;</span><br><span class="line">    element.onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        alert(id);</span><br><span class="line">    &#125;;</span><br><span class="line">    element = <span class="literal">null</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><p>因此可以看出，闭包并不会引起内存泄漏，只是由于IE9之前的版本对JScript对象和COM对象使用不同的垃圾收集，从而导致内存无法进行回收，这是IE的问题，所以正常使用闭包的情况下不会导致内存泄漏。</p>
<p>​                                                            <a href="https://segmentfault.com/a/1190000004665100" target="_blank" rel="noopener">reference – GC的三大基础算法</a></p>
<p>​                                                            <a href="https://jinlong.github.io/2016/05/01/4-Types-of-Memory-Leaks-in-JavaScript-and-How-to-Get-Rid-Of-Them/" target="_blank" rel="noopener">reference – javascript内存泄露及其避免</a></p>
<p>​                                                            <a href="https://segmentfault.com/a/1190000007315908" target="_blank" rel="noopener">闭包会造成内存泄漏吗？</a></p>
</li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/02/01/js-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/02/01/js-3/" itemprop="url">javascript数据、变量类型与预解析</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-02-01T10:16:07+08:00">
                2018-02-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="javascript数据、变量类型与预解析"><a href="#javascript数据、变量类型与预解析" class="headerlink" title="javascript数据、变量类型与预解析"></a>javascript数据、变量类型与预解析</h1><h3 id="javascript数据类型与变量类型如下图："><a href="#javascript数据类型与变量类型如下图：" class="headerlink" title="javascript数据类型与变量类型如下图："></a>javascript数据类型与变量类型如下图：</h3><p><img src="http://upload-images.jianshu.io/upload_images/7166236-a037b00a91520096.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="javascript数据、变量类型.png"></p>
<h3 id="执行上下文（Execution-Context）"><a href="#执行上下文（Execution-Context）" class="headerlink" title="执行上下文（Execution Context）"></a>执行上下文（Execution Context）</h3><blockquote>
<p>每当控制器转到可执行代码的时候，就会进入一个执行上下文，执行上下文可以理解为当前代码的执行环境，他会形成一个作用贵。javascript中的运行环境大概包括三种：</p>
<ul>
<li>全局环境：js代码运行起来首先会进入该环境。</li>
<li>函数环境：当函数被调用执行时，会进入当前函数中的执行代码。</li>
<li>eval（不建议使用，可忽略）</li>
</ul>
</blockquote>
<ul>
<li>因此在一个javascript程序中，必定会产生多个执行上下文，js引擎会以栈的方式处理他们，这个栈我们称其为调用栈<code>（call stack）</code>。栈底永远是全局上下文<code>(Global Context)</code>，而栈顶就是当前执行的上下文。在代码执行过程中，遇到上面3中情况，都会生成一个执行上下文，放入栈中，而处于栈顶的上下文执行完毕之后，就会自动出栈。全局上下文会在浏览器窗口关闭后出栈。</li>
<li>关于上下文的总结：<ul>
<li>单线程</li>
<li>同步执行，只有栈顶的上下文处于执行中，其他上下文需要等待</li>
<li>全局上下文只有唯一的一个，它在浏览器关闭时出栈</li>
<li>函数的执行上下文的个数没有限制</li>
<li>每次某个函数被调用，就会有个新的执行上下文为其创建，即使是调用的自身函数，也是如此。</li>
</ul>
</li>
</ul>
<p><a href="https://yangbo5207.github.io/wutongluo/ji-chu-jin-jie-xi-lie/er-3001-zhi-xing-shang-xia-wen.html" target="_blank" rel="noopener">Reference-执行上下文</a></p>
<h3 id="变量和函数在内存中的展示"><a href="#变量和函数在内存中的展示" class="headerlink" title="变量和函数在内存中的展示"></a>变量和函数在内存中的展示</h3><ul>
<li>基本数据类型是直接存在栈内存中，而引用类型是在栈中存储了指针，该指针指向了堆中该实体的起始地址。当解释器寻找引用值时，会首先检索其在栈中的地址，取得地址后从堆中获得实体。<strong>基本数据类型按照值来访问，引用数据类型按照引用来访问</strong>。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-4967c2b15da52abb.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="预解析（也称声明提升）："><a href="#预解析（也称声明提升）：" class="headerlink" title="预解析（也称声明提升）："></a>预解析（也称声明提升）：</h3><ul>
<li>在ES6之前，变量使用<code>var</code>声明，会存在变量的预解析，函数也有预解析。所谓预解析，就是在当前作用域中，javascript代码执行之前，浏览器首先会默认的把所有带<code>var</code>和<code>function</code>声明的变量进行提前声明或者定义。</li>
<li>声明和定义</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> num = <span class="number">1</span>;	</span><br><span class="line"><span class="comment">//声明： var num：告诉浏览器在全局作用域有一个num变量</span></span><br><span class="line"><span class="comment">//定义：num = 1 ；定义就是给变量进行赋值</span></span><br></pre></td></tr></table></figure>
<ul>
<li><h4 id="var声明的变量和function声明的函数在预解析的区别"><a href="#var声明的变量和function声明的函数在预解析的区别" class="headerlink" title="var声明的变量和function声明的函数在预解析的区别"></a>var声明的变量和function声明的函数在预解析的区别</h4><p><code>var</code>声明的变量和function声明的函数在预解析的时候有区别，<strong><code>var</code>声明的变量在预解析的时候只是提前的声明，<code>function</code>声明的函数在预解析的时候会提前声明并且会同时定义</strong>。也就是说var声明的变量和function声明的函数的区别是在声明的同时有没同时进行定义。下面举个例子：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(num);			<span class="comment">//undefined</span></span><br><span class="line"><span class="built_in">console</span>.log(test);			<span class="comment">//test函数体，而不是undefined</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">test</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'test'</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="built_in">console</span>.log(num);			<span class="comment">//1</span></span><br><span class="line"><span class="built_in">console</span>.log(test);			<span class="comment">//test函数体，没有返回值，所以会在输出一个undefined</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-b4b059b0a4ef44be.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>变量对象的创建过程为：先创建<code>arguments</code>对象，然后检查<code>function</code>函数声明创建属性，最后检查<code>var</code>变量声明创建属性。<strong>因此function声明会比var声明优先级更高一点</strong>，下面举个例子：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(num);	<span class="comment">//打印出了function num 而不是undefined。</span></span><br><span class="line"><span class="keyword">var</span> num = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">num</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">'test'</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-fdfb67b19a0866d1.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>​</p>
<h3 id="预解析的顺序"><a href="#预解析的顺序" class="headerlink" title="预解析的顺序"></a>预解析的顺序</h3><ul>
<li>程序开始先预解析语法，标点符号是否有误，解析内存是否可容纳，解析变量……直到解析无误了，才开始按正常的流程顺序走。如果没有预解析顺序，直接按流程顺序走，可能程序执行到最后一个函数，发现了语法错误，才开始报错，那性能要有多差啊！</li>
<li>顺序内容：</li>
</ul>
<ol>
<li>文件内引用的<code>&lt;script&gt;</code>块依次解析，从上到下连成一片。</li>
<li>每个<code>&lt;script&gt;</code>块内的<code>function</code>，<code>var</code>解析到本块的开头。（先解析<code>function</code>，再解析<code>var</code>）</li>
<li>依次解析每个环境，将<code>function，var</code>解析到环境的开头。</li>
</ol>
<p>​</p>
</li>
</ul>
<p><a href="https://www.jianshu.com/p/c3276ff58c93" target="_blank" rel="noopener">reference–JavaScript中的预解析</a></p>
<p><a href="https://my.oschina.net/zzjweb/blog/651937" target="_blank" rel="noopener">reference–作用域链，预解析,复杂面试题详解</a></p>
<p><a href="https://yangbo5207.github.io/wutongluo/ji-chu-jin-jie-xi-lie/er-3001-zhi-xing-shang-xia-wen.html" target="_blank" rel="noopener">Reference-执行上下文</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/01/28/ng2-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/28/ng2-3/" itemprop="url">Angular2 父子组件通信方式</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-28T14:47:40+08:00">
                2018-01-28
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web框架/" itemprop="url" rel="index">
                    <span itemprop="name">web框架</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <ul>
<li>Angular2官方文档对组件交互这块有详细的介绍–&gt;<a href="https://angular.cn/guide/component-interaction" target="_blank" rel="noopener">文档–组件之间的交互</a>。按文档介绍，组件间交互的方式一共有4种，包括：</li>
</ul>
<blockquote>
<ol>
<li>通过输入型绑定把数据从父组件传到子组件（<code>@Input decoration</code>）；子组件暴露一个<code>EventEmitter</code>属性（<code>@Output decoration</code>），当事件发生时，利用该属性<code>emits</code>向父组件发射事件。</li>
<li>父组件与子组件通过本地变量互动。（<code># var</code>）</li>
<li>父组件调用<code>@ViewChild</code>。</li>
<li>父组件和子组件通过服务来通讯。</li>
</ol>
</blockquote>
<ul>
<li>我在这里只总结、详细介绍3种我在项目中使用过的方法，看完本文大概能做到如下的效果：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-0719c2871bece58f.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>创建项目，项目结构如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-ff5638347a8e81a9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id="通过-Input、-Output装饰器进行父、子组件间的通信"><a href="#通过-Input、-Output装饰器进行父、子组件间的通信" class="headerlink" title="通过@Input、@Output装饰器进行父、子组件间的通信"></a>通过<code>@Input</code>、<code>@Output</code>装饰器进行父、子组件间的通信</h3><ul>
<li><code>@Input</code>：该属性绑定用于父组件向子组件传递数据。子组件可以通过以下两种方法截取属性的变更：<ul>
<li>使用一个输入属性的setter，以拦截父组件中值得变化。</li>
<li>通过<code>ngOnchanges()</code>来截听输入属性值的变化。</li>
</ul>
</li>
<li><code>@Output</code>：该数据绑定用于子组件向父组件传递数据和事件。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--parent.component.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 1000px;margin: auto"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span> <span class="attr">style</span>=<span class="string">"width: 500px;float: left"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">    父组件</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-body"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>父组件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"input"</span>&gt;</span>父组件输入：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"input"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"Input something"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"parentPrint"</span>  </span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"output"</span>&gt;</span>父组件输出：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"output"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"Output something"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"contentFromChild"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-child</span></span></span><br><span class="line"><span class="tag">  [<span class="attr">fromParent</span>]=<span class="string">"parentPrint"</span></span></span><br><span class="line"><span class="tag">  (<span class="attr">fromChild</span>)=<span class="string">"fromChild($event)"</span></span></span><br><span class="line"><span class="tag">&gt;</span><span class="tag">&lt;/<span class="name">app-child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--child.component.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span> <span class="attr">style</span>=<span class="string">"width: 500px;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">    子组件</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-body"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>子组件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"input"</span>&gt;</span>子组件输入：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"input"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"Input something"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"contentFromChild"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"output"</span>&gt;</span>子组件输出：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"output"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"Output something"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"fromParent"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span>  <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> (<span class="attr">click</span>)=<span class="string">"clickChild()"</span>&gt;</span>Output方式<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>效果如下：（1、父组件输入，子组件可同步输出；2、子组件输入需要（3、）点击按钮触发发射事件，将数据传送给父组件。）</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-34dc99ad8b400f46.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li><strong><code>@Input:</code></strong>父组件输入的同时，子组件能同步获取数据进行显示。核心代码如下：</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">parentPrint: <span class="built_in">any</span>;			<span class="comment">//ts中，声明一个变量</span></span><br><span class="line">[(ngModel)]=<span class="string">"parentPrint"</span>	<span class="comment">//html中，绑定变量，获取用户输入</span></span><br><span class="line"><span class="comment">//html中，将数据传给子组件</span></span><br><span class="line">&lt;app-child [fromParent]=<span class="string">"parentPrint"</span>&gt;&lt;<span class="regexp">/app-child&gt; </span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/子组件</span></span><br><span class="line"><span class="regexp">@Input() fromParent;	 	/</span><span class="regexp">/ts中，用于直接接收从父组件获取的数据</span></span><br><span class="line"><span class="regexp">[(ngModel)]="fromParent"	/</span><span class="regexp">/html中，用于显示数据</span></span><br></pre></td></tr></table></figure>
<ul>
<li>通过<code>setter</code>截听输入属性值的变化，在子组件中声明一个私有变量来获取父组件传递过来的数据，从而屏蔽上层获取下层信息。（简单一点就是不让父组件知道子组件用什么东西去接收传过来的数据）通过这种方法也可以获得同样的效果。</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//子组件</span></span><br><span class="line"> <span class="keyword">private</span> _fromParent: <span class="built_in">any</span>;     	<span class="comment">//私有变量，通过setter获取父组件的数据</span></span><br><span class="line"><span class="meta">@Input</span>()                      	<span class="comment">//通过setter获取父组件的数据</span></span><br><span class="line">  <span class="keyword">set</span> fromParent(fromParent: <span class="built_in">any</span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>._fromParent = fromParent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">get</span> fromParent(): <span class="built_in">any</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._fromParent;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong><code>@Output:</code></strong>父组件接收子组件的数据时，子组件暴露一个<code>EventEmitter</code>属性，当事件发生时，子组件利用该属性<code>emits</code>(向上弹射)事件。父组件绑定到这个事件属性，并在事件发生时作出回应。核心代码如下：</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//子组件</span></span><br><span class="line"><span class="meta">@Output</span>() fromChild = <span class="keyword">new</span> EventEmitter&lt;<span class="built_in">any</span>&gt;();	<span class="comment">//暴露一个输出属性</span></span><br><span class="line"></span><br><span class="line">&lt;button  <span class="keyword">class</span>=<span class="string">"btn btn-primary"</span> (click)=<span class="string">"clickChild()"</span>&gt;Output方式&lt;<span class="regexp">/button&gt; </span></span><br><span class="line"><span class="regexp"> /</span><span class="regexp">/触发发射函数，将数据发送给父组件</span></span><br><span class="line"><span class="regexp">  clickChild() &#123;</span></span><br><span class="line"><span class="regexp">    console.log('click child' , this.contentFromChild);</span></span><br><span class="line"><span class="regexp">    this.fromChild.emit(this.contentFromChild);</span></span><br><span class="line"><span class="regexp">  &#125;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//父组件</span></span><br><span class="line">[(ngModel)]=<span class="string">"contentFromChild"</span>  <span class="comment">//绑定输出子组件的数据</span></span><br><span class="line"><span class="comment">//使用子组件，绑定事件属性</span></span><br><span class="line">&lt;app-child</span><br><span class="line">  [fromParent]=<span class="string">"parentPrint"</span></span><br><span class="line">  (fromChild)=<span class="string">"fromChild($event)"</span></span><br><span class="line">&gt;&lt;<span class="regexp">/app-child&gt;</span></span><br><span class="line"><span class="regexp">/</span><span class="regexp">/事件处理函数</span></span><br><span class="line"><span class="regexp"> fromChild(event) &#123;</span></span><br><span class="line"><span class="regexp">   console.log(event);</span></span><br><span class="line"><span class="regexp">   this.contentFromChild = event;</span></span><br><span class="line"><span class="regexp"> &#125;</span></span><br></pre></td></tr></table></figure>
<h3 id="父组件通过调用-ViewChild-来获取子组件的数据"><a href="#父组件通过调用-ViewChild-来获取子组件的数据" class="headerlink" title="父组件通过调用@ViewChild()来获取子组件的数据"></a>父组件通过调用<code>@ViewChild()</code>来获取子组件的数据</h3><ul>
<li>如果父组件的类需要读取子组件的属性和值或调用子组件的方法时，就可以把子组件作为<code>ViewChild</code>，注入到父组件里面。<code>ViewChild</code>顾名思义就是可以看见子组件里面的属性和方法。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--parent.component.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 1000px;margin: auto"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span> <span class="attr">style</span>=<span class="string">"width: 500px;float: left"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">    父组件</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-body"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>父组件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"viewoutput"</span>&gt;</span>ViewChild父组件输出：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"viewoutput"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"ViewChild父组件输出"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"viewOutput"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> (<span class="attr">click</span>)=<span class="string">"clickView()"</span>&gt;</span>ViewChild方式<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-child</span>&gt;</span><span class="tag">&lt;/<span class="name">app-child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--child.component.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span> <span class="attr">style</span>=<span class="string">"width: 500px;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">    子组件</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-body"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>子组件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"input"</span>&gt;</span>子组件输入：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"input"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"Input something"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"contentFromChild"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>效果如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-7bb37d5459bdd836.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>父组件核心代码：</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//ts</span></span><br><span class="line"><span class="meta">@ViewChild</span>(ChildComponent)               	<span class="comment">// 使用viewChild导入引用</span></span><br><span class="line"><span class="keyword">private</span> childComponent: ChildComponent; 	<span class="comment">// 将子组件注入到私有属性</span></span><br><span class="line"><span class="comment">//获取子组件数据并显示</span></span><br><span class="line">clickView() &#123;</span><br><span class="line">  	<span class="comment">//直接获取子组件的属性</span></span><br><span class="line">    <span class="keyword">this</span>.viewOutput = <span class="keyword">this</span>.childComponent.contentFromChild;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//html</span></span><br><span class="line">[(ngModel)]=<span class="string">"viewOutput"</span></span><br><span class="line"> &lt;button <span class="keyword">class</span>=<span class="string">"btn btn-primary"</span> (click)=<span class="string">"clickView()"</span>&gt;ViewChild方式&lt;<span class="regexp">/button&gt;</span></span><br></pre></td></tr></table></figure>
<h3 id="父组件和子组件通过服务来通讯"><a href="#父组件和子组件通过服务来通讯" class="headerlink" title="父组件和子组件通过服务来通讯"></a>父组件和子组件通过服务来通讯</h3><ul>
<li>父组件和它的子组件共享同一个服务，利用该服务在家庭内部实现双向通讯。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--parent.component.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"width: 1000px;margin: auto"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span> <span class="attr">style</span>=<span class="string">"width: 500px;float: left"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">    父组件</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-body"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>父组件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"serviceoutput"</span>&gt;</span>父组件服务输入：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"serviceoutput"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"服务输入"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"serviceInput"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> (<span class="attr">click</span>)=<span class="string">"clickService()"</span>&gt;</span>Service方式<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">app-child</span>&gt;</span><span class="tag">&lt;/<span class="name">app-child</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--child.component.html--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card"</span> <span class="attr">style</span>=<span class="string">"width: 500px;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-header"</span>&gt;</span></span><br><span class="line">    子组件</span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"card-body"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h5</span> <span class="attr">class</span>=<span class="string">"card-title"</span>&gt;</span>子组件<span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"form-group"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"serviceoutput"</span>&gt;</span>子组件服务输入：<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">class</span>=<span class="string">"form-control"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">id</span>=<span class="string">"serviceoutput"</span></span></span><br><span class="line"><span class="tag">             <span class="attr">placeholder</span>=<span class="string">"服务输入"</span></span></span><br><span class="line"><span class="tag">             [(<span class="attr">ngModel</span>)]=<span class="string">"serviceInput"</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">button</span> <span class="attr">class</span>=<span class="string">"btn btn-primary"</span> (<span class="attr">click</span>)=<span class="string">"clickService()"</span>&gt;</span>Service方式<span class="tag">&lt;/<span class="name">button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//服务</span></span><br><span class="line"><span class="comment">//meditor.service.ts</span></span><br><span class="line"><span class="keyword">import</span> &#123;Injectable&#125; <span class="keyword">from</span> <span class="string">'@angular/core'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Subject&#125; <span class="keyword">from</span> <span class="string">'rxjs/Subject'</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;Observable&#125; <span class="keyword">from</span> <span class="string">'rxjs/Observable'</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Injectable</span>()</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">class</span> MeditorService &#123;</span><br><span class="line">  <span class="keyword">private</span> subject = <span class="keyword">new</span> Subject&lt;MeditorMsg&gt;();</span><br><span class="line">  <span class="keyword">constructor</span>(<span class="params"></span>) &#123;&#125;</span><br><span class="line">  <span class="comment">// 获取订阅者</span></span><br><span class="line">  <span class="keyword">public</span> getObservable(): Observable&lt;MeditorMsg&gt; &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.subject.asObservable();</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 推送信息</span></span><br><span class="line">  <span class="keyword">public</span> push(msg: MeditorMsg) &#123;</span><br><span class="line">    <span class="keyword">this</span>.subject.next(msg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 中间者信息</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">interface</span> MeditorMsg &#123;</span><br><span class="line">  id: <span class="built_in">string</span>;</span><br><span class="line">  body: <span class="built_in">any</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>效果如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-03056b04144101fe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h3 id=""><a href="#" class="headerlink" title=" "></a> </h3><ul>
<li>父子组件的核心代码类似，在构造函数中将该服务实例注入到自身，父子组件都有一个唯一的<code>id</code>。无论是父组件还是子组件调用<code>push()</code>方法推送数据，双方都能接收到数据，这时候就要根据<code>id</code>来判断是要父组件使用数据还是子组件使用数据。核心代码如下：</li>
</ul>
<figure class="highlight typescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">subscription: Subscription = <span class="literal">null</span>;  <span class="comment">//初始化一个订阅对象</span></span><br><span class="line"><span class="comment">//子组件构造函数，用于监听数据推送</span></span><br><span class="line"><span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> meditor: MeditorService</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.subscription = meditor.getObservable().subscribe(</span><br><span class="line">      msg =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(msg);</span><br><span class="line">        <span class="keyword">if</span> (msg.id === <span class="string">'parent'</span>) &#123;		<span class="comment">//id为parent，获取父组件数据</span></span><br><span class="line">          <span class="keyword">this</span>.serviceInput = msg.body;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// 子组件将数据推送到中间着，给订阅者</span></span><br><span class="line">clickService() &#123;</span><br><span class="line">    <span class="keyword">this</span>.meditor.push(&#123;id: <span class="string">'parent'</span>, body: <span class="keyword">this</span>.serviceInput&#125;);</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">//父组件构造函数，用于监听数据推送</span></span><br><span class="line"><span class="keyword">constructor</span>(<span class="params"></span></span><br><span class="line"><span class="params">    <span class="keyword">private</span> meditor: MeditorService</span></span><br><span class="line"><span class="params">  </span>) &#123;</span><br><span class="line">    <span class="keyword">this</span>.subscription = meditor.getObservable().subscribe(</span><br><span class="line">      msg =&gt; &#123;</span><br><span class="line">        <span class="built_in">console</span>.log(msg);</span><br><span class="line">        <span class="keyword">if</span> (msg.id === <span class="string">'child'</span>) &#123;		<span class="comment">//id为child，获取子组件数据</span></span><br><span class="line">          <span class="keyword">this</span>.serviceInput = msg.body;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line"><span class="comment">// 父组件将数据推送到中间着，给订阅者</span></span><br><span class="line">clickService() &#123;</span><br><span class="line">    <span class="keyword">this</span>.meditor.push(&#123;id: <span class="string">'parent'</span>, body: <span class="keyword">this</span>.serviceInput&#125;);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>我上面写的还不是很完善，就是在生命周期结束前，也就是在<code>onDestroy</code>周期中，要<strong>取消订阅</strong>。</li>
</ul>
<p>​       以上，就是最近在使用的组件交互的总结。个人觉得通过服务来交互的可扩展性更强。例如，我们项目中用到了一个动态显示的侧栏，不同时期点击显示侧栏要显示不同的东西。这个时候把侧栏作为父组件，子组件作为消息的一部分传递给父组件，父组件根据子组件名动态生成模板，显示在侧栏上面。说了这么多废话大概就是下图的意思：</p>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-6408a8fa3ab28f5d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>最后附上demo源码：<a href="https://github.com/Husbin/web/tree/master/ComponentCommunication" target="_blank" rel="noopener">父子组件交互demo</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/01/22/js-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/22/js-2/" itemprop="url">javascript事件与事件委托</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-22T22:21:18+08:00">
                2018-01-22
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index">
                    <span itemprop="name">javascript</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h4 id="事件："><a href="#事件：" class="headerlink" title="事件："></a>事件：</h4><blockquote>
<p>事件就是文档或浏览器窗口中发生的一些特定的交互瞬间。javascript与HTML之间的交互就是通过事件来实现的。<strong>观察者模型：</strong>使用侦听器或处理程序要预定时间，以便时间发生时执行相应的代码，这种模型支持页面的行为（javascript）与页面的外观（HTML和CSS）之间的松散耦合。</p>
</blockquote>
<h4 id="事件监听器与处理程序："><a href="#事件监听器与处理程序：" class="headerlink" title="事件监听器与处理程序："></a>事件监听器与处理程序：</h4><ul>
<li>响应某个事件的函数就叫做事件处理程序或事件监听器。在触发DOM上的某个事件时，会产生一个事件对象<code>event</code>，这个对象中包含着所有与事件有关的信息，包括导致事件的元素，事件 的类型以及其他与特定事件相关的信息，这个对象不需要定义，可以直接使用。</li>
<li>事件处理程序：事件处理程序的名字以<code>on</code>开头，类似<code>click、load、和 mouseover</code>都是事件的名字，因此，<code>click</code>的事件处理程序就是<code>onclick</code>。案例如下：<code>onclick</code>就是事件处理程序</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"child"</span> <span class="attr">style</span>=<span class="string">"width: 90px;height:90px;background-color: cyan;margin: 0 auto;"</span> <span class="attr">onclick</span>=<span class="string">"showMessage(event)"</span> &gt;</span>孩子<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">showMessage</span><span class="params">(event)</span></span>&#123;</span></span><br><span class="line"><span class="undefined">        alert(event.target.id);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"> </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>事件监听器：例子如下：<code>child.addEventListener(&quot;click&quot;,function (),true)</code>是将指定的监听器注册到<code>child</code>上，当该对象触发指定的事件时，指定的回调函数就会被执行。</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"child"</span> <span class="attr">style</span>=<span class="string">"width: 90px;height:90px;background-color: cyan;margin: 0 auto;"</span> &gt;</span>孩子<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> child = <span class="built_in">document</span>.getElementById(<span class="string">"child"</span>);</span></span><br><span class="line"><span class="undefined">    /**</span></span><br><span class="line"><span class="undefined">     *  事件监听器</span></span><br><span class="line"><span class="undefined">     *  addEventListener(eventName , dealEventFunc , boolean)</span></span><br><span class="line"><span class="undefined">     *  eventName: 要处理的事件名</span></span><br><span class="line"><span class="undefined">     *  dealEventFunc: 作为事件处理程序的函数</span></span><br><span class="line"><span class="actionscript">     *  boolean: <span class="literal">true</span>表捕获事件，<span class="literal">false</span>表冒泡事件</span></span><br><span class="line"><span class="undefined">     * */</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// 捕获事件流</span></span></span><br><span class="line"><span class="actionscript">    child.addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      	<span class="comment">//取消冒泡</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//event.stopPropagation();          //w3c</span></span></span><br><span class="line"><span class="actionscript">        <span class="comment">//event.cancelBubble = true;        //IE</span></span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"捕获事件流：click child!"</span>);</span></span><br><span class="line"><span class="actionscript">    &#125;,<span class="literal">true</span>);</span></span><br><span class="line"><span class="actionscript">    <span class="comment">//冒泡事件流</span></span></span><br><span class="line"><span class="actionscript">    child.addEventListener(<span class="string">"click"</span>,<span class="function"><span class="keyword">function</span> <span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        <span class="built_in">console</span>.log(<span class="string">"冒泡事件流：click child!"</span>);</span></span><br><span class="line"><span class="actionscript">    &#125;,<span class="literal">false</span>);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="事件流："><a href="#事件流：" class="headerlink" title="事件流："></a>事件流：</h4><ul>
<li>构建一棵dom树如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-7ea31711b0a97b9d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ol>
<li>IE事件流：事件冒泡流。</li>
</ol>
<blockquote>
<p>事件开始时由最具体的元素（文档中嵌到层次最深的那个节点）接收，然后逐级向上传播到较为不具体的节点（文档）。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-99ab05f566aa2f19.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>点击<code>child</code>的<code>&lt;div&gt;</code>，显示如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-93635f7dfc7e1750.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>点击<code>parent</code>的<code>&lt;div&gt;</code>，显示如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-a1efe0cd4c2f8b3d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ol>
<li>NetSpace事件流：事件捕获流。</li>
</ol>
<blockquote>
<p>事件捕获的思想是不太具体的节点应该更早接收到事件，而最具体的节点应该最后接收到事件，事件捕获的用意在于在事件到达预定目标之前捕获他。</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-a6f4cf8620b9905b.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>点击<code>child</code>的<code>&lt;div&gt;</code>，显示如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-ad770bbb4064b989.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>点击<code>parent</code>的<code>&lt;div&gt;</code>，显示如下：</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-a00520e7b3c8833e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ol>
<li>DOM事件流：包括三个阶段：事件捕获阶段、处于目标阶段、事件冒泡阶段。</li>
</ol>
<blockquote>
<p>DOM2级事件规定的事件流包括三个阶段：事件捕获阶段、处于目标阶段和事件冒泡阶段。首先发生的是事件捕获，为截获事件提供了机会，然后是实际的目标接收到事件。最后一个阶段是冒泡阶段，可以在这个阶段对事件做出响应。</p>
<p>下图，捕获阶段：1，2，3，4</p>
<p>处于目标阶段在事件处理中被看成是冒泡阶段的一部分</p>
<p>然后冒泡事件发生：5，6，7，8，9</p>
</blockquote>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-dc3b24d733fc42d9.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h4 id="阻止事件冒泡"><a href="#阻止事件冒泡" class="headerlink" title="阻止事件冒泡"></a>阻止事件冒泡</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">event.stopPropagation();          <span class="comment">//w3c</span></span><br><span class="line">event.cancelBubble = <span class="literal">true</span>;        <span class="comment">//IE</span></span><br></pre></td></tr></table></figure>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-c1b983a015164c9e.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h4 id="事件委托"><a href="#事件委托" class="headerlink" title="事件委托"></a>事件委托</h4><ul>
<li><strong>内存和性能：</strong>在javascript中，添加到页面上的时间处理程序数量将直接影响到页面的整体运行性能。导致这一问题的原因是多方面的，首先，每个函数都是对象，都会占用内存；内存中的对象越多，性能就越差。其次，必须事先指定所有事件处理程序而导致的DOM访问次数，会延迟整个页面的交互就绪时间。</li>
<li><strong>事件委托：</strong>事件委托利用了事件冒泡，只指定一个事件处理程序，就可以管理某一类型的所有事件。使整个页面只有少量的函数，从而优化页面性能。实例代码如下：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span> <span class="attr">id</span>=<span class="string">"html"</span> <span class="attr">onclick</span>=<span class="string">"clickDiv(event)"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span> <span class="attr">id</span>=<span class="string">"body"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"grandparent"</span> <span class="attr">style</span>=<span class="string">"width: 270px;height:270px;background-color: blue; margin: 0 auto; text-align: center;line-height: 3"</span>&gt;</span>祖父</span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"parent"</span> <span class="attr">style</span>=<span class="string">"width: 180px;height:180px;background-color: cadetblue;margin: 0 auto;"</span>&gt;</span>父亲</span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"child"</span> <span class="attr">style</span>=<span class="string">"width: 90px;height:90px;background-color: cyan;margin: 0 auto;"</span> &gt;</span>孩子</span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> child = <span class="built_in">document</span>.getElementById(<span class="string">"child"</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> parent = <span class="built_in">document</span>.getElementById(<span class="string">"parent"</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> grandparent = <span class="built_in">document</span>.getElementById(<span class="string">"grandparent"</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> body = <span class="built_in">document</span>.getElementById(<span class="string">"body"</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">let</span> html = <span class="built_in">document</span>.getElementById(<span class="string">"html"</span>);</span></span><br><span class="line"><span class="actionscript">    <span class="function"><span class="keyword">function</span> <span class="title">clickDiv</span><span class="params">(event)</span></span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">switch</span> (event.target.id)&#123;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">case</span> <span class="string">'child'</span>:<span class="built_in">console</span>.log(<span class="string">"click child!"</span>);<span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">case</span> <span class="string">'parent'</span>:<span class="built_in">console</span>.log(<span class="string">"click parent!"</span>);<span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">case</span> <span class="string">'grandparent'</span>:<span class="built_in">console</span>.log(<span class="string">"click grandparent!"</span>);<span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">case</span> <span class="string">'body'</span>:<span class="built_in">console</span>.log(<span class="string">"click body!"</span>);<span class="keyword">break</span>;</span></span><br><span class="line"><span class="javascript">            <span class="keyword">case</span> <span class="string">'html'</span>:<span class="built_in">console</span>.log(<span class="string">"click html!"</span>);<span class="keyword">break</span>;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>在<code>&lt;html&gt;</code>标签中添加了<code>onclick(event)</code>事件处理程序。由于其他标签都是<code>&lt;html&gt;</code>的子节点，而且他们的事件会冒泡，所以单击事件终会被这个函数处理，点击各个点的输出情况如下所示。与给每个节点加一个处理程序相比，这种方法需要占用的内存更少，只添加了一个处理程序，虽然对用户来说最终结果都相同，但这种技术需要占用的内存更少，<strong>所有用到按钮的事件都适合采用事件委托技术</strong>。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-1ef58d04fea91443.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<ul>
<li>如果可行的话，也可以考虑为<code>document</code>对象添加一个事件处理程序，用以处理页面上发生的某种特定类型的事件，这样做与传统的做法相比具有如下优点：<ol>
<li><code>document</code>对象很快就可以访问，而且可以在生命周期的任何时间点上为它添加事件处理程序。‘</li>
<li>在页面中设置事件处理程序所需的时间更少，只添加体格事件处理程序所需的DOM引用更少，所花的时间也更少。</li>
<li>真个页面占用的内存空间更少，能够提升整体性能。</li>
</ol>
</li>
<li><a href="https://github.com/Husbin/web/blob/master/javascript/base/eventBubble.html" target="_blank" rel="noopener">整个demo代码</a></li>
</ul>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/01/13/base-3/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/13/base-3/" itemprop="url">图解BOM与DOM的区别、联系</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-13T21:22:57+08:00">
                2018-01-13
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web基础知识/" itemprop="url" rel="index">
                    <span itemprop="name">web基础知识</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="区别"><a href="#区别" class="headerlink" title="区别"></a>区别</h2><h3 id="BOM（Browser-Object-Model）"><a href="#BOM（Browser-Object-Model）" class="headerlink" title="BOM（Browser Object Model）"></a>BOM（Browser Object Model）</h3><blockquote>
<p>BOM 即浏览器对象模型，BOM没有相关标准，<strong>BOM的最核心对象是window对象</strong>。windiw对象既为javascript访问浏览器提供API，同时在ECMAScript中充当Global对象。BOM和浏览器关系密切，浏览器很多东西可以通过javascript控制，例如打开窗口、打开选项卡、关闭页面、收藏夹等。这些功能与网页内容无关。由于没有标准，不同的浏览器实现同一功能，可以通过不同的实现方式。例如，加入收藏夹这个功能：</p>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt; IE浏览器: <span class="built_in">window</span>.external.AddFavorite(url,title);</span><br><span class="line">&gt;</span><br><span class="line">&gt; FireFox浏览器: <span class="built_in">window</span>.sidebar.addPanel(title, url, <span class="string">""</span>);</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<p>虽然没有统一标准，但是各个浏览器的常用功能的js代码大同小异，对于常用的功能已经有默认的标准了。</p>
</blockquote>
<h3 id="DOM（Document-Object-Model）"><a href="#DOM（Document-Object-Model）" class="headerlink" title="DOM（Document Object Model）"></a>DOM（Document Object Model）</h3><blockquote>
<p>DOM即文档对象模型，DOM是W3C标准，<strong>DOM的最根本对象是document（window.document）</strong>，这个对象实际上是window对象的属性，这个对象的独特之处是这个是唯一一个既属于BOM又属于DOM的对象。DOM和文档有关，这里的文档指的是网页，也就是html文档。DOM和浏览器无关，他关注的是网页本身的内容，由于和浏览器没有多大的关系，所以标准就好定了。</p>
</blockquote>
<h2 id="BOM与DOM的联系"><a href="#BOM与DOM的联系" class="headerlink" title="BOM与DOM的联系"></a>BOM与DOM的联系</h2><p><img src="http://upload-images.jianshu.io/upload_images/7166236-ac9c88e8fc0cb3c4.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-8f4701a13ad06f23.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="DOM (1).png"></p>
<p><a href="http://blog.csdn.net/xiao__gui/article/details/8315148" target="_blank" rel="noopener">Reference - JavaScript学习：BOM和DOM的区别和关联</a></p>
<p><a href="https://www.jianshu.com/p/f5409202a835" target="_blank" rel="noopener">Reference - 图解：window与BOM的关系</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/01/12/base-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/12/base-2/" itemprop="url">web开发必备常识</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-12T22:04:09+08:00">
                2018-01-12
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web基础知识/" itemprop="url" rel="index">
                    <span itemprop="name">web基础知识</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="W3C标准"><a href="#W3C标准" class="headerlink" title="W3C标准"></a>W3C标准</h1><h3 id="w3c标准是一系列标准的集合。包括以下几个部分："><a href="#w3c标准是一系列标准的集合。包括以下几个部分：" class="headerlink" title="w3c标准是一系列标准的集合。包括以下几个部分："></a>w3c标准是一系列标准的集合。包括以下几个部分：</h3><ul>
<li><h5 id="结构标准语言（Structure）："><a href="#结构标准语言（Structure）：" class="headerlink" title="结构标准语言（Structure）："></a>结构标准语言（Structure）：</h5></li>
</ul>
<blockquote>
<p>可扩展标记语言（XML）</p>
<p>可扩展超文本标记语言（XHTML/HTML）</p>
</blockquote>
<ul>
<li><h5 id="表现标准语言（Presentation）："><a href="#表现标准语言（Presentation）：" class="headerlink" title="表现标准语言（Presentation）："></a>表现标准语言（Presentation）：</h5></li>
</ul>
<blockquote>
<p>层叠样式表（CSS）</p>
</blockquote>
<ul>
<li><h5 id="行为标准（Behavior）："><a href="#行为标准（Behavior）：" class="headerlink" title="行为标准（Behavior）："></a>行为标准（Behavior）：</h5></li>
</ul>
<blockquote>
<p>文档对象类型（DOM）</p>
<p>ECMAScript</p>
</blockquote>
<h4 id="思维导图："><a href="#思维导图：" class="headerlink" title="思维导图："></a>思维导图：</h4><p><img src="http://upload-images.jianshu.io/upload_images/7166236-88a64d4a03a65289.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="W3C标准 .png"></p>
<h1 id="浏览器内核"><a href="#浏览器内核" class="headerlink" title="浏览器内核"></a>浏览器内核</h1><h3 id="浏览器内核主要分成两部分：渲染引擎-layout-engineer或Rendering-Engine-和JS引擎："><a href="#浏览器内核主要分成两部分：渲染引擎-layout-engineer或Rendering-Engine-和JS引擎：" class="headerlink" title="浏览器内核主要分成两部分：渲染引擎(layout engineer或Rendering Engine)和JS引擎："></a>浏览器内核主要分成两部分：渲染引擎(layout engineer或Rendering Engine)和JS引擎：</h3><ul>
<li><h5 id="渲染引擎："><a href="#渲染引擎：" class="headerlink" title="渲染引擎："></a>渲染引擎：</h5></li>
</ul>
<blockquote>
<p>也称排版引擎，解释引擎。负责取得网页的内容（HTML、XML、图像等等）、整理讯息（例如加入CSS等），以及计算网页的显示方式，然后会输出至显示器或打印机。浏览器的内核的不同对于网页的语法解释会有不同，所以渲染的效果也不相同。所有网页浏览器、电子邮件客户端以及其它需要编辑、显示网络内容的应用程序都需要内核。</p>
</blockquote>
<ul>
<li><h5 id="JS引擎："><a href="#JS引擎：" class="headerlink" title="JS引擎："></a>JS引擎：</h5></li>
</ul>
<blockquote>
<p>解析和执行javascript来实现网页的动态效果。</p>
<p>最开始渲染引擎和JS引擎并没有区分的很明确，后来JS引擎越来越独立，<strong>内核就倾向于只指渲染引擎</strong>。</p>
</blockquote>
<ul>
<li><h5 id="市场上主流浏览器的内核："><a href="#市场上主流浏览器的内核：" class="headerlink" title="市场上主流浏览器的内核："></a>市场上主流浏览器的内核：</h5><ol>
<li>Trident内核：IE , MaxThon , 腾讯TT , The World , 360 , 搜狗浏览器等。</li>
<li>Gecko内核：Netscape6及以上版本 , MozillaSuite/SeaMonkey等</li>
<li>WebKit内核：Safari，Chrome , Chrome的：Blink（WebKit的分支）（微信内置浏览器内核 X5 blink）</li>
<li>Presto内核：Opera7及以上。</li>
</ol>
<p><a href="http://www.cnblogs.com/fullhouse/archive/2011/12/19/2293455.html" target="_blank" rel="noopener">Reference-浏览器内核的解析和对比</a></p>
</li>
</ul>
<h1 id="Javacript的组成"><a href="#Javacript的组成" class="headerlink" title="Javacript的组成"></a>Javacript的组成</h1><p><a href="http://www.huar.love/blog/2017/05/27/javas/index.html" target="_blank" rel="noopener">转自-JavaScript组成</a></p>
<p>JavaScript和ECMAScript通常都被人们用来表达相同的含义，但是JavaScript的含义却比ECMA-262的要多得多，一个完整的JavaScript有三个组成部分组成。</p>
<figure class="highlight gcode"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">核心<span class="comment">(ECMAScript)</span></span><br><span class="line">文档对象模型<span class="comment">(DOM)</span></span><br><span class="line">浏览器对象模型<span class="comment">(BOM)</span></span><br></pre></td></tr></table></figure>
<h3 id="JavaScript语言组成部分包含"><a href="#JavaScript语言组成部分包含" class="headerlink" title="JavaScript语言组成部分包含"></a>JavaScript语言组成部分包含</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">语法</span><br><span class="line">类型</span><br><span class="line">语句</span><br><span class="line">关键字</span><br><span class="line">保留字</span><br><span class="line">操作符</span><br><span class="line">对象</span><br></pre></td></tr></table></figure>
<h3 id="文档对象模型-DOM-Document-Object-Model"><a href="#文档对象模型-DOM-Document-Object-Model" class="headerlink" title="文档对象模型(DOM Document Object Model)"></a>文档对象模型(DOM Document Object Model)</h3><p>针对XML但经过扩展用于HTML的应用程序编程接口，DOM把整个页面映射成一个多节点结构，HTML或XML页面中的每个组成部分都是某种类型的节点，这些节点包含不同类型的数据。</p>
<h3 id="浏览器对象模型-BOM"><a href="#浏览器对象模型-BOM" class="headerlink" title="浏览器对象模型(BOM)"></a>浏览器对象模型(BOM)</h3><p>支持可以操作和访问浏览器窗口的浏览器对象模型(BOM Browser Object Model),开发人员可以使用BOM控制浏览器显示的页面以外的部分。</p>
<p>从根本上讲，BOM只处理浏览器窗口和框架，但人们习惯上把针对浏览器的JavaScript扩展算作BOM的一部分，下面就是这样的扩展;</p>
<figure class="highlight autohotkey"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">弹出浏览器窗口</span><br><span class="line">移动、缩放、和关闭浏览器窗口功能</span><br><span class="line">提供浏览器详细功能的`navigator`对象</span><br><span class="line">提供浏览器所加载页面的详细`location`对象</span><br><span class="line">提供用户显示器分辨率纤细信息的`screen`对象</span><br><span class="line">对`Cookies`的支持</span><br><span class="line">像`XMLHttpRequest`和IE的`ActiveObject`这样的自定义对象</span><br></pre></td></tr></table></figure>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://easywork.xin/2018/01/11/base-1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Husbin">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/img/favicon.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Husbin">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2018/01/11/base-1/" itemprop="url">跨域问题</a></h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-01-11T20:25:09+08:00">
                2018-01-11
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/web基础知识/" itemprop="url" rel="index">
                    <span itemprop="name">web基础知识</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong>出现跨域问题的原因：</strong></p>
<blockquote>
<p>同源策略</p>
</blockquote>
<h2 id="同源策略"><a href="#同源策略" class="headerlink" title="同源策略"></a>同源策略</h2><h4 id="三同"><a href="#三同" class="headerlink" title="三同"></a>三同</h4><ul>
<li>协议相同</li>
<li>域名相同</li>
<li>端口相同</li>
</ul>
<h4 id="同源策略目的"><a href="#同源策略目的" class="headerlink" title="同源策略目的"></a>同源策略目的</h4><ul>
<li>保证用户信息安全，防止恶意网站窃取数据。同源策略是必须的，否则cookie可以共享。</li>
</ul>
<h4 id="同源策略的限制范围"><a href="#同源策略的限制范围" class="headerlink" title="同源策略的限制范围"></a>同源策略的限制范围</h4><ul>
<li>cookie、localstorage、indexdb无法读取。</li>
<li>DOM无法获取。</li>
<li>ajax请求不能发送。</li>
</ul>
<h4 id="规避策略"><a href="#规避策略" class="headerlink" title="规避策略"></a>规避策略</h4><ol>
<li>cookie：设置<code>document.domain</code>共享cookie。</li>
<li>DOM获取：（父子页面通信）H5引入了一个API，这个API为windows对象新增了一个<code>window.postMessage</code>方法，允许跨窗口通信，无论这两个窗口是否同源。</li>
</ol>
<blockquote>
<p><code>window.opener.postMessage(content,origin)</code></p>
<p>content是消息的具体内容，origin是<code>协议 + 域名 + 端口</code></p>
</blockquote>
<ol>
<li>AJAX：</li>
</ol>
<ul>
<li>JSONP：JSONP是服务器无客户端跨源通信的常用方法。基本思想是网页通过添加一个<code>&lt;script&gt;</code>元素，向服务器请求json数据，这种做法不受同源政策的限制，服务器收到请求后，将数据放在一个指定名字的回调函数里面传回来。（只能发GET请求）</li>
<li>WebSocket：<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/WebSocket" target="_blank" rel="noopener">WebSocket</a>是一种通信协议。使用<code>ws://</code>（非加密）和<code>wss://</code>（加密）作为协议前缀。该协议不实行同源政策，只要服务器支持，就可以通过它进行跨源通信。</li>
<li>CORS：详解如下。</li>
</ul>
<h2 id="CORS"><a href="#CORS" class="headerlink" title="CORS"></a>CORS</h2><blockquote>
<p>跨域资源共享（corss-origin resource sharing）：CORS需要浏览器和服务器同时支持。目前所有浏览器都支持该功能，IE浏览器不能低于IE10。整个CORS通信过程，都是浏览器自动完成，不需要用户参与。对于开发者来说，CORS通信与同源的AJAX通信没有差别，代码完全一样。浏览器一旦发现AJAX请求跨源，就会自动添加一些附加的头信息，有时还会多出一次附加的请求，但用户不会有感觉。因此，实现CORS通信的关键是服务器。只要服务器实现了CORS接口，就可以跨源通信。</p>
</blockquote>
<h3 id="两种请求"><a href="#两种请求" class="headerlink" title="两种请求"></a>两种请求</h3><ul>
<li>浏览器将CORS请求分成两类：简单请求（simple request）和非简单请求（not-so-simple request）。</li>
</ul>
<p><img src="http://upload-images.jianshu.io/upload_images/7166236-acd3c54d85bf38e5.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="CORS请求.png"></p>
<h3 id="1-简单请求"><a href="#1-简单请求" class="headerlink" title="1. 简单请求"></a>1. 简单请求</h3><ul>
<li>对于简单请求，浏览器直接发出CORS请求。具体来说，就是<strong>在Header中增加一个<code>Origin</code>字段</strong>。如果浏览器发现跨源AJAX请求是简单请求，就自动在头信息之中，添加一个<code>Origin</code>字段。</li>
</ul>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">GET /cors HTTP/1.1		</span><br><span class="line"><span class="attribute">Origin</span>: http://easywork.xin		//浏览器添加字段，说明本次请求来自哪个源（协议+域名+端口）。</span><br><span class="line"><span class="attribute">Host</span>: 119.23.214.114</span><br><span class="line"><span class="attribute">Accept-Language</span>: en-US</span><br><span class="line"><span class="attribute">Connection</span>: keep-alive</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0...</span><br></pre></td></tr></table></figure>
<ul>
<li><p>服务器根据<code>Origin</code>的值决定是否同意这次请求。</p>
<blockquote>
<p>如果<code>Origin</code>指定的源在不在后端的许可白名单范围内，服务器会返回一个正常的http回应。浏览器接收后发现，这个<code>response</code>的Header没有包含<code>Access-Control-Allow-Origin</code>字段，就知道出错了，从而抛出一个错误，被<code>XMLHttpRequest</code>的<code>onerror</code>回调函数捕获。<strong>这种错误无法通过状态码识别，因此HTTP response的状态码有可能是200。</strong></p>
<p>如果<code>Origin</code>指定的域名在许可的范围内，则服务器返回的相应中，会多出几个头信息字段</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&gt; Access-Control-Allow-Origin: http://easywork.xin</span><br><span class="line">&gt; Access-Control-Allow-Credentials: true</span><br><span class="line">&gt; Access-Control-Expose-Headers: FooBar</span><br><span class="line">&gt; Content-Type: text/html; charset=utf-8</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
</blockquote>
<p>&gt;</p>
<blockquote>
<ul>
<li><code>Access-Control-Allow-Origin</code>：（必须字段）它的值要么是请求时<code>Origin</code>的值，要么是<code>*</code>，表示接受任意域名的请求。</li>
<li><code>Access-Control-Allow-Credentials</code>：（可选字段）它是一个bool值，表示是否允许发送Cookie。默认情况下，Cookie不包括在CORS请求之中。设为true，表示服务器明确许可，Cookie可以包含在请求中，一起发给服务器。CORS请求默认不发送Cookie和HTTP认证信息。如果要把Cookie发送到服务器，一方面要服务器同意，指定<code>Access-Control-Allow-Credentials:true</code>；另一方面，前端必须在AJAX请求中打开<code>withCredentials</code>属性：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&gt; <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span><br><span class="line">&gt; xhr.withCredentials = <span class="literal">true</span>;</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>注意：如果要发送Cookie，<code>Access-Control-Allow-Origin</code>不能设置为<code>*</code> ，必须指定明确的，与请求网页一致的域名。同时，Cookie依然遵守同源政策，只有用服务器域名设置的Cookie才会上传，其他域名的Cookie并不会上传。</strong></li>
</ul>
<ul>
<li>Access-Control-Expose-Headers<code>：（可选字段）CORS请求时，</code>XMLHttpRequest<code>对象的</code>getResponseHeader(args)<code>方法只能拿到6个基本字段：</code>Cache-Control<code>、</code>Content-Language<code>、</code>Content-Type<code>、</code>Expires<code>、</code>Last-Modified<code>、</code>Pragma<code>。如果想拿到其他字段，就必须在</code>Access-Control-Expose-Headers`里面指定。</li>
</ul>
</blockquote>
</li>
</ul>
<h4 id="2-非简单请求"><a href="#2-非简单请求" class="headerlink" title="2. 非简单请求"></a>2. 非简单请求</h4><ul>
<li>非简单请求是那种对服务器有特殊要求的请求，比如请求方法是<code>PUT</code>或<code>DELETE</code>，或者<code>Content-Type</code>字段的类型是<code>application/json</code>。</li>
<li>非简单请求的CORS请求，会在正式通信之前，增加一次HTTP查询请求，称为”预检”请求（preflight）。浏览器先询问服务器，当前网页所在的域名是否在服务器的许可名单之中，以及可以使用哪些HTTP动词和头信息字段。只有得到肯定答复，浏览器才会发出正式的<code>XMLHttpRequest</code>请求，否则就报错。</li>
</ul>
<h3 id="与JSONP比较"><a href="#与JSONP比较" class="headerlink" title="与JSONP比较"></a>与JSONP比较</h3><ul>
<li>CORS与JSONP的使用目的相同，但是比JSONP更强大。JSONP只支持GET请求，CORS支持所有类型的HTTP请求。JSONP的优势在于支持老式的浏览器，以及可以向比支持CORS的网站请求数据。</li>
</ul>
<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a href="http://www.ruanyifeng.com/blog/2016/04/same-origin-policy.html" target="_blank" rel="noopener">阮一峰-浏览器同源政策及其规避方法</a></p>
<p><a href="http://www.ruanyifeng.com/blog/2016/04/cors.html" target="_blank" rel="noopener">阮一峰-跨域资源共享 CORS 详解</a></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/3/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/5/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/img/favicon.jpg"
                alt="Husbin" />
            
              <p class="site-author-name" itemprop="name">Husbin</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">50</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">9</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">14</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Husbin</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
